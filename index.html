<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NFC Drag Builder</title>

<style>
body {
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;
  background:#0f0f10;
  color:#fff;
}
.app {
  max-width:420px;
  margin:auto;
  padding:20px;
}
.widget {
  background:#1a1a1d;
  border-radius:14px;
  padding:14px;
  margin-bottom:12px;
  cursor:grab;
}
.widget.dragging {
  opacity:.5;
}
textarea,input {
  width:100%;
  border:none;
  border-radius:10px;
  padding:10px;
  font-size:15px;
  margin-top:6px;
}
img {
  width:100%;
  border-radius:10px;
  margin-top:8px;
}
.fab {
  position:fixed;
  right:16px;
  bottom:16px;
  width:56px;
  height:56px;
  border-radius:50%;
  background:linear-gradient(135deg,#6a5cff,#00e0ff);
  border:none;
  font-size:30px;
  cursor:pointer;
}
.drawer {
  position:fixed;
  right:-220px;
  top:0;
  height:100%;
  width:200px;
  background:#1a1a1d;
  padding:20px;
  transition:.3s;
}
.drawer.open { right:0; }
.drawer button {
  width:100%;
  padding:12px;
  margin-bottom:10px;
  border:none;
  border-radius:10px;
  font-weight:600;
}
.save {
  width:100%;
  margin-top:20px;
  padding:14px;
  border-radius:14px;
  border:none;
  background:linear-gradient(135deg,#6a5cff,#00e0ff);
  font-weight:700;
}
</style>
</head>

<body>

<div class="app" id="list"></div>
<button class="save" onclick="save()">Uložit</button>

<button class="fab" onclick="toggle()">+</button>

<div class="drawer" id="drawer">
  <button onclick="addText()">Text</button>
  <button onclick="addPhoto()">Fotka</button>
</div>

<script>
const KEY="nfc-dnd";
let widgets=JSON.parse(localStorage.getItem(KEY))||[];
let dragIndex=null;

function toggle(){
  drawer.classList.toggle("open");
}

function addText(){
  widgets.push({type:"text",value:""});
  toggle(); render();
}
function addPhoto(){
  widgets.push({type:"photo",value:""});
  toggle(); render();
}

function render(){
  list.innerHTML="";
  widgets.forEach((w,i)=>{
    const d=document.createElement("div");
    d.className="widget";
    d.draggable=true;

    d.ondragstart=()=>{dragIndex=i; d.classList.add("dragging");};
    d.ondragend=()=>d.classList.remove("dragging");
    d.ondragover=e=>e.preventDefault();
    d.ondrop=()=>swap(i);

    if(w.type==="text"){
      d.innerHTML=`<textarea placeholder="Text..." 
        oninput="widgets[${i}].value=this.value">${w.value}</textarea>`;
    }
    if(w.type==="photo"){
      d.innerHTML=`<input placeholder="URL fotky" 
        oninput="widgets[${i}].value=this.value" value="${w.value}">
        ${w.value?`<img src="${w.value}">`:""}`;
    }
    list.appendChild(d);
  });
}

function swap(i){
  if(dragIndex===null) return;
  [widgets[i],widgets[dragIndex]]=[widgets[dragIndex],widgets[i]];
  dragIndex=null;
  render();
}

function save(){
  localStorage.setItem(KEY,JSON.stringify(widgets));
  alert("Uloženo ✔️");
}

render();
</script>
</body>
</html>
